<!DOCTYPE html>
<html>
  <head>
    <script src="common.js"></script>
    <script src="../../js/header.js"></script>
    <link rel="stylesheet" href="common.css" />
    <link rel="stylesheet" href="../../css/default.css" />
    <script>
      function init() {
        const data = {
          title: "第36回高専プロコン参加記",
          date: [2025, 10, 18],
          content: [
            `[今回のレポジトリ(github)](https://github.com/Unfixed-official/procon-36)`,
            ``,
            `1. 初めに`,
            `---`,
            `我々長岡高専は「Unfixed」([Twitter](https://x.com/UFX_official))というチーム名でこの[第36回全国高等専門学校プログラミングコンテスト](https://www.procon.gr.jp/?page_id=80481)の競技部門に参加した。`,
            `メンバーには、去年と同様の[千葉](https://x.com/chiba15683)と、四年生の先輩を加え、三人での参加となった。`,
            ``,
            ``,
            `1. 問題`,
            `---`,
            `[原文](https://www.procon.gr.jp/?p=80689)は長いのでAHC風に嚙み砕いたものを示す。`,
            `> 一辺が2Nの正方形領域の各マスに数字が書き込まれていて、左上のマスから下にi、右にjだけ進んだマスに書き込まれた値をAijと書くことにします。また、入力は次を満たします。`,
            `> ・各0≤i<2N²について、iがちょうど二個書き込まれている。つまり、0以上2N²未満の全てのiについて、Akl=iを満たすような整数の組(k,l)が丁度2個存在する。`,
            `> このとき、目的の盤面を次のように設定します。`,
            `> ・全てのマスに対し、そのマスに接するマスの内いずれかに同じ数字が書き込まれているマスが存在する。つまり、全ての(i,j)に対し、Aij=Ai(j-1),Aij=Ai(j+1),Aij=A(i-1)j,Aij=A(i+1)jのいずれかが成り立つ。`,
            `> この時、あなたは次の操作を0回以上行うことができます。`,
            `> ・ある一辺が2以上の正方形領域に対して、その領域を90°右に回転する。`,
            `> この時手数をできるだけ減らす方法を考えてください。`,
            `> また、問題の制約上、必ず有限回の操作で目標の盤面に到達することが可能です。`,
            `> 制約`,
            `> ・4 ≤ 2N ≤ 24`,
            ``,
            `また、公式では次の用語も定義されている。`,
            `> 各数字: エンティティ`,
            `> 正方形の領域: 園`,
            `> 回転操作: 導き`,
            ``,
            ``,
            `1. 準備期間`,
            `---`,
            ``,
            `1.1. 四、五月 ～考察編～`,
            `問題が配布された。「今年はガチるぞ！」と意気込んでとりあえず考察から始めた。`,
            `「え！？24って小さくね！？」`,
            `と、今思えば[去年の奴](https://www.procon.gr.jp/?page_id=79774)のせいで感覚がマヒっているがそう思った。(256はデカすぎた)`,
            `まずは貪欲解から実装することにしたが、色々種類があるのでとりあえずどれが良さそうか考えることにした。`,
            ``,
            ``,
            `1.1. 六月 ～実装編～`,
            `一番ベタな上から0,1,2,3,...揃えると揃えていく解法を実装した。この方法だと、「www」という名前で提出されている通り、平均して約3000手かかった。([出典](https://x.com/kammyu_unfixed/status/1977577361311940813))`,
            `一旦BFSで最も手数の少ないものを揃えるようにすると、1500手は切れた。`,
            `他に考えた種類としては、真ん中で揃えてから外側に持っていく(多分八戸の第1フェーズ？)のが三種類と、本番で用いた(後述)正方形を残すようにする手法があった。`,
            ``,
            `特に六月は、commitを見る限り6/20に頑張ってたっぽい。`,
            `当時の変更記録(\`changelog.log\`)を引用する。`,
            `> ver 1.0.0 - とりあえずそろえる`,
            `> 　実装。`,
            `> ver 1.0.1 - readmeの修正`,
            `> 　改行が入るように改善`,
            `> `,
            `> ver 1.1.0 - main.cppの修正`,
            `> 　最後の二行で隣り合った時に揃わなくなるバグを修正`,
            `> 　テストケースの更新`,
            `> `,
            `> ver 1.2.0 - main.cppの改善`,
            `> 　0からではなく、すでに配置されている数字をもとに配置するようにした。`,
            `> 　これにより、二倍の最適化が期待される。`,
            `> `,
            `> ver 1.2.1 - main.cppの改善`,
            `> 　その都度最も近い数を探してそれをそろえることにした。`,
            `> 　数10手の削減が期待される。`,
            `\\img(65) diary_gitcommits.png`,
            `\\align{center} 当時のコミットの様子`,
            ``,
            ``,
            `1.1. 八、九月 ～？？？～`,
            `Heuristic青だああああああ！！！！(AtCoder)`,
            `え？夏休み？知らない子ですねぇ...`,
            ``,
            ``,
            `1.1. 十月 ～最終調整？いいえ実装です～`,
            `大会まで残り10日ほど。さすがにまずいと思い、出場メンバー三人で集まることに。役割は、`,
            `千葉→通信、資料作り`,
            `kαmμ、先輩→solver作り`,
            `という風に割り振った。`,
            `とりあえず先輩とともにsolverの共同製作を始めた。`,
            `とりあえず正方形を右下に残して二行二列ずつ揃える手法(以下L字解法と略す)を考えて先輩に言ったが、まさか同じことを考えているとは思わなかった。`,
            `その時に先輩(競プロ未経験)にビームサーチとは何かを教えた。(大会時点でビームサーチとは何たるかを理解していて驚愕した)`,
            `無事L字解法(貪欲法)が完成した。この時点で、手数は24x24で約600手程。しかし問題発生。例のかさはらmadeのサイトに500手切りを確認。(大会直前は370手とか←おかしい)`,
            `10月4日、ビームサーチを完成。この時点でのビーム幅は100くらいだった気がする。手数は570手位に改善。(あんま改善しなくてしょっぱい)`,
            `最後に4x4を残すようにして前計算全探索で\`O(1)\`で最短手順を取り出せるようにした。`,
            `この時点では盤面の評価の計算について、盤面をコピーして実際に評価を行うことにしていた。`,
            `実際にコピーせずにペア数の計算は園の周だけ行うようにした。`,
            `他にも、(各マスからのターゲットへの到達)経路探索BFSを毎回行っていたが、これを同等の盤面について、メモしておくことで高速化を図った。`,
            `-# ここで言う同等の盤面は、貪欲に揃えた領域が等しいものを表す。`,
            `高速化を頑張ったことによって、ビーム幅は57600程まで大きくできた。やったね！530手！！！`,
            `## これ最後の方全部前日の話です`,
            `-# (下の内容と被る)`,
            ``,
            ``,
            `1. 現地`,
            `---`,
            `1.1. 前日`,
            `前日、学校をフルで休んで(特別欠席)、七時間の移動を経て到着(詳しくはコチラ(準備中)を参照)。`,
            `会場にて受付を行い、大量で去年より豪華なノベリティに圧倒され、「とうとう始まったな」ということを実感した(まだ始まっていないが)。`,
            `その後ホテルにチェックインし、荷物の整理を始めた。取り敢えず三人で集まって、パンフレットからの天啓を期待したり、簡易サーバーとの通信のテストなどを行った。`,
            `この時は、盤面のサイズが練習-一回戦-敗者復活戦-準決勝-ラストワン-決勝の順に。`,
            `この時はだいたい4-8-8-16-16-24とかだと思ってた。`,
            `> 俺8x8用の別解法作るんで先輩盤面大きいほうの最終調整やっててください`,
            `-# 当時の俺の発言`,
            `→普通に寝た。うん。`,
            ``,
            ``,
            `1.1. 一日目`,
            `1.1.1. 準備`,
            `> 6:30 起床`,
            `> 7:00 朝食`,
            `> 8:00 ホテル出発`,
            `> 8:20 会場到着`,
            `> 9:30 開会式`,
            `みたいな感じだった`,
            ``,
            `会場に着くと、既に多くのチームが集まっていた。速すぎだろ`,
            `受付を済ませ、席に着くと、競技開始まで一時間ほどあったので、最後の調整を行っていた。`,
            `と、この時点で緊急事態発生！参加者連絡会議で千葉がもらってきた大会内容の詳細に14の文字が！`,
            `> 一回戦の盤面の大きさは**14x14**。`,
            `-# 補足：適当に思い出して書いたら多分文面は間違ってる`,
            `🦈「初手を14x14にして参加者を驚かせましょう！」`,
            `じゃねえよふざけんな`,
            `まあ別にだからと言って特別な処置をしたわけではなかったが。`,
            `とりあえず、通信の確認、solverの最終確認などを行った。`,
            ``,
            `1.1.1. 通信確認の予行練習(8x8)`,
            `ようやく競技開始。緊張が高まる中、予行練習が行われた。`,
            `そして自分たちの番が来て競技開始。`,
            `ぐるぐるするやつ、(自分が出した案ではないが)先を越されてしまった。が、普通にやった。`,
            `結果から言うと、8x8が45手位？覚えてないけど。`,
            `普通にここの結果だけ見ればスコアが低すぎる(手数が多すぎる)ので、準決迄行けるか怪しかった。`,
            ``,
            `1.1.1. 昼休み`,
            `うん。量大杉！！！`,
            `なんでみんなこの量を平気で食べてるの？`,
            `あと毎年思ってるけどお茶が苦いんじゃ(おこちゃま)`,
            `昼休みの間ずっと食ってた気がする。食い始めたのが多分12:10くらいで食い終わったのが12:50くらい。`,
            `-# 美味かった`,
            `[昼休み中のある気付き](https://x.com/kammyu_unfixed/status/1976845186245574935)`,
            ``,
            `1.1.1. 一回戦`,
            `さあ本番一回戦。せめて準決行きたいなぁと思いつつみんなどれくらいの期間頑張ってたんだろうとふと思った。`,
            `ピリピリした雰囲気の中響き渡る「選手、入場！」、の声。今となってはもう聞き飽きた(?)`,
            `自分たちは第6試合だったためすべての試合を観戦したが、やっぱり例の競プロ鯖にいる強豪校たちが第5,6試合に偏っている！おかしい！！！`,
            `見ている間に先輩が14x14のテストケースを5個くらい試してくれていた。この時点では平均で157手位らしい。`,
            `1~4試合目の感想としては意外とボーダーが低くて二位、三位とれそうだった(五位以上が勝ち上がり)`,
            `勝手な分析だが、多分みんな12x12とかしかoptimizeしてなくて、それが功を奏したんじゃないかと。`,
            `第5試合で状況が一変。上に書いたように、第5試合も強豪校が集まっていたが、結果から見るにボーダー通過が結構怪しかった。(ってか普通にレベル高すぎ)`,
            ``,
            `第6試合、とうとう手番が回ってきた。`,
            `一回戦第六試合は第一ブースから`,
            `> 久留米 仙台(広瀬) 徳山 津山 茨城 八戸 サレジオ 長岡 佐世保`,
            `の順です。よかったら[Youtubeでアーカイブ](https://www.youtube.com/live/K7LuFhOzpZE)残ってるから見てね。`,
            `とりあえず複数回ビーム幅を変えて実行して前回値より良くなっていたら提出する方針で行った。`,
            `結果は**155手**で**7位**！(5位 徳山高専 110手←は？？？？？？)`,
            `う～ん、どうしたものか。`,
            `いやこれはおかしいだろ。だって1~4試合だったらストレートに準決行けてたもん`,
            `あれ？七行上の分析は？？？？`,
            ``,
            `1.1.1. 特別講演`,
            `神って実在するんだなぁと思いました。`,
            `これを機にYouTubeガチってRuby書いて新しいプログラミング言語作ってみようかしら(←!?)`,
            `金の盾生で見たの初めて。`,
            `比較的有意義だったと思う。`,
            ``,
            `1.1.1. 学生交流会`,
            `# 島根島根島根島根生まれの島根しまねっこ`,
            ``,
            `1.1.1. 帰宅(家じゃないよ)`,
            `ホテルに帰ってきました。`,
            `大会を見返している中でいいなと思ったのが、木更津高専の解法でした。選んだ理由として自分たちと似たような解法でかつ、手数が大幅にこちらより少なかったことがあります。`,
            `一応一日目夜の行動の方針を決めました：`,
            `> kαmμ→盤面全体評価+ビムサ(通称：ぐちゃぐちゃ解法)`,
            `> 先輩→木更津高専を~~パク~~リスペクトしてL字解法を改良`,
            `> 千葉→**_睡眠担当_**`,
            ``,
            `自分は、まずはパンフに全部曝け出してくれていた茨城の愚直実装をして、それが終わったのが23:24くらいっぽい。`,
            `そのあとバグのfixが終わったのが00:27くらい。`,
            `その後、14x14を風呂入ってる間にずっと動かしていたが、なんかペア数93/98くらいから全く動いてなかった。マジで最悪。俺の時間を返してくれ。`,
            `そのまま着替えて寝た。("寝るなよ" by 執筆時点の俺)`,
            `その間先輩は木更津解法をやってくれていたっぽい。(23:02時点)`,
            `「結局ぐるぐるで揃えるようにした」って来たときはめっちゃ吃驚した。私達のL字解法はどこに行っちゃったんですか。`,
            ``,
            ``,
            `1.1. 二日目`,
            `---`,
            `1.1.1. 準備`,
            `> 6:30 起床`,
            `> 7:00 朝食`,
            `> 7:40 ホテル出発`,
            `> 8:00 会場到着`,
            `みたいな感じだった。高専生に朝はつらい。`,
            `因みに前日に寝たのが2:30くらいらしい。何をしていたんですか貴方は。`,
            ``,
            `あと敗者復活戦始まんの8:30はイカれてる。`,
            ``,
            `1.1.1. 敗者復活戦`,
            `さあ本番敗者復活戦。せめて準決行きたいなぁ。(n回目)`,
            `なんかね、うん。もうね、眠いわ。`,
            `「例年(n=1)だったら敗者復活戦は一回戦と盤面の大きさ同じだし14x14くるだろうなぁ」とか思ってみたり「みんなどれくらい14x14に対してoptimizeしてきたんやろなぁ」とか思ってみたりした。`,
            `因みに準決に上がれるのは各ブースで上位二校のみ。`,
            `、、、`,
            `🦈「こんどは16x16にして参加者を驚かせましょう！」`,
            `？？？？？？？？`,
            `はい。そういうことです。案の定外周を埋めたりL字解法を1layerだけやったりして14x14に落とし込んでそこから独自の解法で解いている高専が結構いました。`,
            `第一試合は流しました。はい。(ずっとぐちゃぐちゃ解法改良してた。)`,
            ``,
            `一方(?)、Unfixedこと長岡高専は試合を第二試合に控えていた。`,
            `いったんここで有志の方が作ってくださった暫定順位表を見ておきますか`,
            `[元ポスト](https://x.com/KMnO4aq/status/1976889304426463272)`,
            `\\img(60) losers_match_Allscore.png`,
            `この表について軽く説明すると、一日目で6位以下(敗者復活戦行き)となったチームを寄せ集めて、一回戦(14x14)のスコアで昇順に並べたものです。(111手の宇部がいるのおかしい)`,
            ``,
            `敗者復活戦第二試合は第一ブースから`,
            `> 都城 一関 呉 長岡 釧路 旭川 岐阜 富山(射水)`,
            `となっております。`,
            `はいと言うことでやっていきましょう。`,
            `# 一位 長岡高専 189手！！！`,
            `Q. 敗者復活戦で勝って楽しいか！`,
            `A. はい。気持ちよかったです。`,
            `第三試合目も流しました。(宇部が139出しててすごかったし、久留米が185手出してたからここだったら準決に上がれてなかった。)`,
            ``,
            `あの～何でしょう、次私達、また八戸(決勝一位)と徳山(決勝三位)と当たるんですか？(両者一回戦第六試合で既に当たっている)`,
            ``,
            `1.1.1. 準決勝`,
            `さあ本番準決勝。せめて決勝行きたいなぁ。(1回目)`,
            `とりあえずまずいので頑張ってチューニングした。`,
            `ｼﾞｭﾝｹｯｼｮｳﾊ20x20ﾀﾞﾖ!!!`,
            ``,
            `準決勝第二試合は第一ブースから`,
            `> 明石 八戸 香川(高松) 豊田 大阪公大 熊本(八代) 沖縄 徳山 長岡`,
            `みたいな感じ。先の敗者復活戦も含めてアーカイブは[こちら](https://www.youtube.com/live/17TcESvPbFg)`,
            `まあそろそろ緊張が麻痺してきました。全然体温も内部の感情も変わりません。`,
            `いや～みんな強かった。長岡高専は**四位**(308手)通過でラストワン決定戦行きでした。`,
            `その後、残りの二試合を流しつつラストワン決定戦に向けて準備し続けた。`,
            ``,
            `1.1.1. ラストワン決定戦`,
            `さあ本番ラストワン決定戦。せめて決勝行きたいなぁ。(2回目)`,
            `ラストワンも20x20です。＼(^o^)／`,
            ``,
            `ラストワン決定戦は第一ブースから`,
            `> 茨城 豊田 木更津 サレジオ 米子 長岡 宇部 鳥羽商船`,
            `の順です。顔見知りが多いですね。そうです。長岡は既に半分くらい当たってます。`,
            `あの～なんて言うんでしょう、先輩、ぐちゃぐちゃ解法完成しなくて本当に申し訳ありません。`,
            `というわけであとはやるだけといったところでしょうか。結果を見ていきましょう。`,
            `# 長岡高専、302手で6位！`,
            `いや～せめて300切りたかったんですけどね。運が味方してくれませんでした。(←おい)`,
            `あの**木更津高専**(決勝六位)が233手で決勝進出しました。`,
            `ん？木更津高専？やっぱり模倣はオリジナルには敵わないってことですね！`,
            `-# 見た感じ、揃えるときの揃え方の多様性の点で負けてたっぽい。`,
            ``,
            `1.1.1. 決勝`,
            `# 八戸高専優勝おめでとうございます！`,
            `一応決勝進出校と成績をば`,
            `> 1位 八戸高専 307手`,
            `> 2位 東京高専 310手`,
            `> 3位 徳山高専 319手`,
            `> 4位 仙台(広瀬)高専 342手`,
            `> 5位 木更津高専 355手`,
            `> 6位 石川高専 364手`,
            `> 7位 大島商船高専 370手`,
            `> 8位 香川(詫間)高専 399手`,
            `> 9位 群馬高専 392手(1ペア揃わず)`,
            `決勝はずっと見てたけど、なんかもうよくわかんなかった。うん。なんだよ307手って。俺らの20x20と同等じゃねぇか`,
            `群馬高専は5:15で385手(8位相当)解がでてたらしい。マジでどんまい過ぎる`,
            `> ...TLE後、5:15で385手の解が出たが、...`,
            `[かふぇさんの記事](https://note.com/cafe_j19419/n/nad20c1479362?sub_rt=share_sb)より`,
            ``,
            `1.1.1. 石見神楽`,
            `もおおおおおお！！！！分からんんんんん！！！！`,
            `とにかく迫力はあった。臭いもすごかったし、とにかく視界が色とりどりだった。`,
            `background音楽も(というか自分目線そっちの方が)めっちゃよかった。参考にしたいかも。`,
            `裏でずっとぐちゃぐちゃ解法動かしてた。なんで揃わないんだよおおおおおおおおお！！！！！！`,
            `本番でぐちゃぐちゃ解法使った方、ぐちゃぐちゃ解法の実装の仕方が分かる方がいれば、良ければ[こちら](https://x.com/kammyu_unfixed/status/1977578379852616165)に教えてください。`,
            `あとめっちゃ申し訳ないけどこの時間帯めっちゃ眠くなるんだ、、、`,
            ``,
            ``,
            `1.1.1. ホテルに戻る`,
            `はい。戻りました。`,
            `Q. 何をしたでしょう？`,
            `A. そうです。強化学習ですね。`,
            `実装が終わったのが大体0:30くらいでした。`,
            `その後風呂に入ってる間ずっと学習させてました。`,
            `おい！揃うところまで行ってないやんけ！！！`,
            `～完～`,
            ``,
            ``,
            `1.1. 延長戦(移動日含め四日目)`,
            `1.1.1. 準備`,
            `> 6:00 起床`,
            `> 6:30 朝食`,
            `> 7:00 チェックアウト＋ホテル出発`,
            `早えよ、狂ってるよ。`,
            ``,
            `# 出雲大社に行って来ました。`,
            `う～ん、特に書けることがない、、、`,
            `強いて言えば二礼**四**拍手一礼であることを知ったくらい。`,
            `あとお土産買った。`,
            ``,
            `1.1.1. 高専プロコン帰宅部門`,
            `行き同様、七時間の移動を経て無事帰宅。疲れた。`,
            `酔った。うん。この時からこの記事書き始めてたんだよな、、、`,
            `寝てるときに歯が口の中にくっつくやつあるじゃん、それで口内が抉れて軽い口内炎みたいになった。執筆時点(10/18)でもまだ治ってなくて痛い`,
            `あと、寝た時にちょうど飴舐め始めたんだけど起きた時ちゃんと口の中にいてすげえ(?)ってなった。`,
            `-# めっちゃ口の中にくっついてた`,
            ``,
            ``,
            `1. まとめ`,
            `---`,
            `プロコンだけで体感250件くらいツイートしてた気がする。`,
            `後普通にこれ一から作るの疲れた。`,
            `全体的な結果はこの通り：`,
            `> 一回戦：7位`,
            `> 敗者復活戦：1位`,
            `> 準決勝：4位`,
            `> ラストワン決定戦：5位`,
            `> 全体：13位/54校`,
            `[出典](https://x.com/UFX_Official/status/1977206655717982489)`,
            `うん、まあ悪くないんじゃないかな？`,
            `今回の高専プロコンでは、準決勝まで進むことができ、とても有意義な経験をすることができた。(まあ去年が悲惨過ぎたと捉えることもできるが。)`,
            `俺らにはまだ3年ある！ということでまだ八戸の現役チームいるかもしれないけど来年優勝します！！！対戦よろしくお願いします！！`,
            ``,
            `最後に、今回の大会を運営してくださった関係者の皆様に深く感謝申し上げます。`,
          ],
        };

        addHeader();
        applyStyle1("main");
        setup("main", data);
      }
    </script>
  </head>
  <body onload="init();">
    <span id="main" />
  </body>
</html>
